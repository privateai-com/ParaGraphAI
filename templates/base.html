{% load static %} {% load i18n %}

<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet" />
    <title>{% block title %} {% trans 'Приложение для проверки научных статей' %} {% endblock %}</title>
    <style>
      :root {
        --body-bg-color: #ffffff;

        --page-width: 1440px;
        --primary-color: #4f46e5;
        --secondary-color: #ffffff;

        --light-button-bg-color: #fdfdfd;

        --paper-bg-color: #ffffff;
        --paper-border: 1px solid var(--primary-color);

        --bg-color-pair-n: #eee;

        --border-color: #dfdfdf;

        --border-radius: 5px;

        --header-bg-color: var(--body-bg-color);

        --global-font-size: 14px;

        --nav-font-size: 14px;

        --primary-button-text-color: #ffffff;

        --profile-button-bg-color: #4f46e5;
        --profile-button-text-color: #ffffff;

        --overlay-background-color: rgba(0, 0, 0, 0.5);
      }

      a {
        color: var(--primary-color);
        text-decoration: none;
      }

      body {
        font-family: "Open Sans", sans-serif;
        margin: 0;
        padding: 0;
        line-height: 1.333;
        font-size: var(--global-font-size);
        background-color: #ffffff;
        color: #333;
      }

      * {
        box-sizing: border-box;
        max-width: 100%;
      }
      * > *:first-child {
        margin-top: 0px;
      }

      .root {
        display: flex;
        flex-direction: column;
        min-height: 100svh;
      }

      .page {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      header {
        top: 0;
        z-index: 1000;
      }

      button:disabled {
        cursor: not-allowed;
      }

      nav a {
        color: inherit;
        padding: 10px;
        font-size: var(--nav-font-size);
        font-weight: 500;
        display: inline-block;
        text-decoration: none;
      }

      .container-wrap {
        padding: 0 20px;
        width: var(--page-width, 80%);
        max-width: 100%;

        margin: 0px auto;
      }

      dialog {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--body-bg-color);

        z-index: 1001;
      }

      dialog::after {
        content: "";
        background: rgba(0, 0, 0, 0.25);
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100vw;
        height: 100svh;
        z-index: -1;
      }

      .container {
        display: flex;
        flex-direction: column;
        width: var(--page-width, 80%);
        max-width: 100%;
        flex: 1;
        margin: 20px auto 20px;
        padding: 0 20px;
      }

      .container:last-child {
        margin-bottom: 20px;
      }

      .container-contained,
      .form-container-contained {
        padding: 20px;
        background-color: white;
        border: 1px solid var(--border-color);
      }

      .form-container-contained {
        max-width: 600px;
        text-align: center;
        margin: auto;
        border-radius: var(--border-radius);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
      }

      .header {
        display: flex;
        flex-direction: column;
      }

      .header-nav {
        flex: 1;
        display: flex;
        gap: 10px;
        justify-content: center;
        text-align: center;
      }

      .header-logo {
        padding: 10px;
        font-weight: 700;
        display: inline-block;
        text-decoration: none;
        font-size: 30px;
        color: inherit;
      }

      h1,
      h2 {
        color: #333;
      }
      .messages {
        list-style: none;
        padding: 0;
      }
      .messages li.success {
        background-color: #d4edda;
        color: #155724;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #c3e6cb;
      }
      .messages li.error {
        background-color: #f8d7da;
        color: #721c24;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #f5c6cb;
      }

      #notifications-wrapper {
        pointer-events: none;
        position: fixed;
        bottom: 0;
        right: 0;
        display: flex;
        flex-direction: column;
        z-index: 1020; /* Должен быть выше другого контента в .container */
        /* background-color: #f8f9fa;  */
        /* Фон, чтобы текст не накладывался */
        padding: 0; /* Уберем внутренние отступы у wrapper */
        margin: 20px; /* Отступ снизу до основного контента */
        /* border-bottom: 1px solid #dee2e6; */
        /* box-shadow: 0 2px 4px rgba(0,0,0,0.05); */
      }

      #notifications-wrapper * {
        pointer-events: all;
      }

      #notifications-toggle-button {
        display: inline-flex;
        color: var(--primary-color);
        margin-left: auto;
        padding: 10px;
        border-radius: 100%;
        background-color: #f8f9fa;
        cursor: pointer;
        border: 2px solid var(--primary-color);
      }

      .toggle-button-opened-svg {
        display: none;
      }
      .show .toggle-button-opened-svg {
        display: flex;
      }

      .toggle-button-closed-svg {
        display: flex;
      }
      .show .toggle-button-opened-svg {
        display: none;
      }

      #notifications {
        overflow-wrap: anywhere;
        /* Сам блок для сообщений */
        display: none;
        margin-bottom: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
        background-color: var(--secondary-color);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        padding: 10px; /* Внутренние отступы для сообщений */
        width: 300px;
        max-width: 100%;
        max-height: 30vh;
        min-height: 100px;
        overflow-y: auto; /* Прокрутка, если много сообщений */
      }

      .show #notifications {
        display: block;
      }

      /* Стили для уведомлений WebSocket */
      #notifications div {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 5px;
        border-radius: var(--border-radius);
        font-size: 0.9em;
      }

      #notifications div:last-child {
        margin-bottom: 0px;
      }

      .status-PIPELINE_START,
      .status-SUBTASK_QUEUED,
      .status-SUBTASK_STARTED {
        background-color: #e0e0e0;
      }
      .status-PENDING {
        background-color: #e0e0e0;
      }
      .status-PROGRESS {
        background-color: #fff0c1;
        overflow-wrap: anywhere;
      }
      .status-SUCCESS,
      .status-PIPELINE_COMPLETE {
        overflow-wrap: anywhere;
        background-color: #d4edda;
        color: #155724;
      }
      .status-FAILURE,
      .status-PIPELINE_FAILURE,
      .status-PIPELINE_ERROR,
      .status-SUBTASK_FAILURE {
        background-color: #f8d7da;
        color: #721c24;
      }
      .status-RETRYING,
      .status-WARNING {
        background-color: #fcf8e3;
        color: #8a6d3b;
      }
      .status-INFO,
      .status-NOT_FOUND {
        background-color: #d1ecf1;
        color: #0c5460;
      }

      form p {
        margin-bottom: 10px;
      }
      form label {
        display: block;
        margin-bottom: 5px;
      }
      form input[type="text"],
      form input[type="password"],
      form select {
        width: calc(100% - 22px);
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
      }

      .errorlist {
        color: red;
        list-style-type: none;
        padding-left: 0;
      }
      .header-row {
        flex: 1;
        display: flex;
        align-items: center;
        /* justify-content: center; */
      }

      .header-left-side,
      .header-right-side {
        flex: 1;
      }

      .header-right-side {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 10px;
      }

      .header-right-side .primary-button {
        padding-left: 20px;
        padding-right: 20px;
      }

      .header-row-full-width {
        background: var(--header-bg-color);
        border-bottom: 1px solid #ddd;
        padding: 10px 0;
      }

      .header-row-full-width.sticky {
        position: sticky;
        position: -webkit-sticky;
        top: 0;
        z-index: 100;
      }

      .header-row {
        width: 100%;
        max-width: var(--page-width, 80%);
        margin: 0 auto;
        padding: 0 20px;
      }

      .primary-button,
      button {
        padding: 11px;
        text-align: center;
        border-radius: var(--border-radius);
        background: var(--primary-color);
        border: none;
        color: var(--primary-button-text-color);
        text-decoration: none;
        font-size: 14px;
        cursor: pointer;
        letter-spacing: 0.15px;
      }

      button:disabled {
        opacity: 0.4;
      }

      button {
        cursor: pointer;
      }

      .stroked-button {
        /* box-shadow: 0 2px 4px rgba(0,0,0,0.25); */
        padding: 11px;
        border-radius: var(--border-radius);
        background: none;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        text-decoration: none;
        font-size: 14px;
        cursor: pointer;
        letter-spacing: 0.15px;
      }

      .cancel-button {
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
        padding: 11px;
        text-align: center;
        border-radius: var(--border-radius);
        background: #d9534f;
        border: none;
        color: var(--primary-button-text-color);
        text-decoration: none;
        font-size: 14px;
        cursor: pointer;
        letter-spacing: 0.15px;
      }

      .profile-button {
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
        width: 40px;
        min-width: 40px;
        height: 40px;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        border-radius: 100%;
        background-color: transparent;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        /* background: var(--profile-button-bg-color); */
        /* color:var(--profile-button-text-color); */
        text-decoration: none;
        font-size: 14px;
        letter-spacing: 0.5px;
        cursor: default;
        text-transform: uppercase;
        /* border: none; */
      }

      nav a.current {
        color: var(--primary-color);
      }

      .tab-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        background: var(--body-bg-color);
        z-index: 1000;
        padding-bottom: 20px;
      }

      .tab-button {
        padding: 8px !important;
        border-radius: var(--border-radius);
        white-space: nowrap;
        flex: 1;
        border: none;
        cursor: pointer;
        font-weight: 500;
        background: none;
        font-size: 13px;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
      }

      .tab-button.active {
        background: var(--primary-color);
        color: var(--primary-button-text-color);
      }

      .tab-container {
        display: flex;
        flex-direction: column;
        flex: 1;
        max-height: 100%;
      }

      .tab-content {
        padding: 20px;
        background-color: var(--paper-bg-color);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        display: none;
        flex: 1;
        position: relative;
        max-height: 100%;
        overflow: hidden;
        gap: 20px;
      }

      .tab-content.active {
        display: flex;
        flex-direction: column;
      }

      .tab-content h3 {
        margin: 0;
      }

      .scrollable-content {
        flex: 1;
        padding: 10px;
        border-radius: var(--border-radius);
        overflow-y: auto;
        width: 100%;
        max-height: 100%;
        border: 1px solid var(--border-color);
        /* padding: 0 10px 0 0; */
      }

      .modal-toggle-button {
        height: 40px;
        width: 40px;
        display: flex;
        align-items: center;
        padding: 0;
        justify-content: center;
        background: none;
        border-radius: 100%;
        border: 2px solid var(--primary-color);
      }
    </style>
    {% block extra_head %}{% endblock %}
  </head>

  <body class="root">
    <header>
      <div class="header">
        <div class="header-row-full-width">
          <div class="header-row">
            <div class="header-left-side" style="color: var(--primary-color)">
              <!-- ParaGraph AI Logo - Paste SVG content below -->
              <svg class="styles_sidebar_logo__dujfi styles_open__dOv5M styles_desktop_logo__5V7yX" height="66" width="210" viewBox="0 0 347 113" xmlns="http://www.w3.org/2000/svg">
                  <path d="M23.5876 41.7474C26.2383 41.7474 28.392 41.3451 30.0486 40.5404C31.7053 39.7358 32.9123 38.5998 33.6696 37.1324C34.4743 35.6651 34.8766 33.9611 34.8766 32.0204C34.8766 28.9438 33.9773 26.5534 32.1786 24.8494C30.4273 23.1454 27.5636 22.2934 23.5876 22.2934H11.7306V41.7474H23.5876ZM40.4856 32.0204C40.4856 33.9611 40.1543 35.8308 39.4916 37.6294C38.8763 39.3808 37.8823 40.9428 36.5096 42.3154C35.137 43.6881 33.3856 44.7768 31.2556 45.5814C29.1256 46.3388 26.5696 46.7174 23.5876 46.7174H11.7306V67.0234H6.05063V17.3234H23.5876C27.469 17.3234 30.6403 17.9861 33.1016 19.3114C35.6103 20.6368 37.4563 22.4118 38.6396 24.6364C39.8703 26.8611 40.4856 29.3224 40.4856 32.0204ZM71.1793 67.0234L70.7533 60.6334C69.7593 62.8108 68.2919 64.5148 66.3513 65.7454C64.4106 66.9288 61.9493 67.5204 58.9673 67.5204C56.4113 67.5204 54.2339 67.1181 52.4353 66.3134C50.6366 65.5088 49.2403 64.3728 48.2463 62.9054C47.2996 61.3908 46.8263 59.6158 46.8263 57.5804C46.8263 54.5984 47.9386 52.1608 50.1633 50.2674C52.3879 48.3268 55.6066 47.1434 59.8193 46.7174L70.7533 45.5104V42.6704C70.7533 40.6824 70.0196 39.0968 68.5523 37.9134C67.0849 36.6828 65.0969 36.0674 62.5883 36.0674C60.1269 36.0674 58.0679 36.6354 56.4113 37.7714C54.8019 38.9074 53.6896 40.5404 53.0743 42.6704L48.2463 40.9664C49.1929 37.8424 50.9206 35.4048 53.4293 33.6534C55.9853 31.9021 59.0856 31.0264 62.7303 31.0264C66.9429 31.0264 70.2089 32.1151 72.5283 34.2924C74.8949 36.4224 76.0783 39.3334 76.0783 43.0254V67.0234H71.1793ZM70.7533 50.0544L59.7483 51.3324C57.3816 51.6164 55.5829 52.2791 54.3523 53.3204C53.1216 54.3144 52.5063 55.6398 52.5063 57.2964C52.5063 58.9531 53.0979 60.2784 54.2813 61.2724C55.5119 62.2664 57.2633 62.7634 59.5353 62.7634C62.1386 62.7634 64.2686 62.2428 65.9253 61.2014C67.5819 60.1601 68.7889 58.7638 69.5463 57.0124C70.3509 55.2138 70.7533 53.2731 70.7533 51.1904V50.0544ZM86.467 31.5234H91.366L91.65 36.7064C92.5967 35.4284 93.7327 34.3398 95.058 33.4404C96.4307 32.5411 97.9217 31.9258 99.531 31.5944C101.188 31.2158 102.939 31.1921 104.785 31.5234V36.8484C102.797 36.4698 100.998 36.4698 99.389 36.8484C97.827 37.2271 96.478 37.9371 95.342 38.9784C94.206 40.0198 93.3303 41.3451 92.715 42.9544C92.0997 44.5164 91.792 46.3388 91.792 48.4214V67.0234H86.467V31.5234ZM134.275 67.0234L133.849 60.6334C132.855 62.8108 131.388 64.5148 129.447 65.7454C127.506 66.9288 125.045 67.5204 122.063 67.5204C119.507 67.5204 117.33 67.1181 115.531 66.3134C113.732 65.5088 112.336 64.3728 111.342 62.9054C110.395 61.3908 109.922 59.6158 109.922 57.5804C109.922 54.5984 111.034 52.1608 113.259 50.2674C115.484 48.3268 118.702 47.1434 122.915 46.7174L133.849 45.5104V42.6704C133.849 40.6824 133.115 39.0968 131.648 37.9134C130.181 36.6828 128.193 36.0674 125.684 36.0674C123.223 36.0674 121.164 36.6354 119.507 37.7714C117.898 38.9074 116.785 40.5404 116.17 42.6704L111.342 40.9664C112.289 37.8424 114.016 35.4048 116.525 33.6534C119.081 31.9021 122.181 31.0264 125.826 31.0264C130.039 31.0264 133.305 32.1151 135.624 34.2924C137.991 36.4224 139.174 39.3334 139.174 43.0254V67.0234H134.275ZM133.849 50.0544L122.844 51.3324C120.477 51.6164 118.679 52.2791 117.448 53.3204C116.217 54.3144 115.602 55.6398 115.602 57.2964C115.602 58.9531 116.194 60.2784 117.377 61.2724C118.608 62.2664 120.359 62.7634 122.631 62.7634C125.234 62.7634 127.364 62.2428 129.021 61.2014C130.678 60.1601 131.885 58.7638 132.642 57.0124C133.447 55.2138 133.849 53.2731 133.849 51.1904V50.0544ZM185.631 33.0854C184.069 30.1981 182.104 28.1391 179.738 26.9084C177.371 25.6304 174.815 24.9914 172.07 24.9914C169.088 24.9914 166.413 25.7251 164.047 27.1924C161.68 28.6598 159.787 30.6951 158.367 33.2984C156.994 35.8544 156.308 38.8128 156.308 42.1734C156.308 45.5814 156.97 48.5871 158.296 51.1904C159.668 53.7464 161.538 55.7581 163.905 57.2254C166.319 58.6454 169.064 59.3554 172.141 59.3554C174.176 59.3554 176.069 59.0004 177.821 58.2904C179.619 57.5804 181.181 56.6101 182.507 55.3794C183.879 54.1488 184.992 52.7051 185.844 51.0484V46.9304H172.283V39.2624H195.216V52.2554C194.08 55.0008 192.399 57.5568 190.175 59.9234C187.95 62.2428 185.276 64.0888 182.152 65.4614C179.075 66.8341 175.643 67.5204 171.857 67.5204C168.212 67.5204 164.851 66.9051 161.775 65.6744C158.745 64.4438 156.071 62.7161 153.752 60.4914C151.48 58.2194 149.705 55.5451 148.427 52.4684C147.149 49.3444 146.51 45.9128 146.51 42.1734C146.51 38.4814 147.149 35.0971 148.427 32.0204C149.705 28.8964 151.48 26.1984 153.752 23.9264C156.024 21.6544 158.698 19.9031 161.775 18.6724C164.851 17.4418 168.188 16.8264 171.786 16.8264C175.099 16.8264 178.247 17.3708 181.229 18.4594C184.211 19.5008 186.838 21.0391 189.11 23.0744C191.382 25.0624 193.133 27.5001 194.364 30.3874L185.631 33.0854ZM202.441 31.5234H210.677L211.316 36.0674C212.31 34.8368 213.422 33.8428 214.653 33.0854C215.931 32.2808 217.327 31.7364 218.842 31.4524C220.357 31.1211 221.942 31.1448 223.599 31.5234V40.0434C222.321 39.6174 220.972 39.4991 219.552 39.6884C218.179 39.8778 216.878 40.3748 215.647 41.1794C214.464 41.9841 213.47 43.1438 212.665 44.6584C211.908 46.1258 211.529 47.9954 211.529 50.2674V67.0234H202.441V31.5234ZM250.287 67.0234L249.577 62.6924C248.393 64.1598 247.044 65.3194 245.53 66.1714C244.062 67.0234 242.074 67.4494 239.566 67.4494C237.199 67.4494 235.116 67.0471 233.318 66.2424C231.566 65.3904 230.194 64.2308 229.2 62.7634C228.206 61.2488 227.709 59.4738 227.709 57.4384C227.709 54.4564 228.774 51.9951 230.904 50.0544C233.081 48.0664 236.347 46.8121 240.702 46.2914L249.577 45.2974V42.8124C249.577 41.8184 249.127 40.8954 248.228 40.0434C247.328 39.1914 245.908 38.7654 243.968 38.7654C242.264 38.7654 240.773 39.1914 239.495 40.0434C238.264 40.8481 237.436 42.0788 237.01 43.7354L229.2 40.8954C230.146 37.7241 231.945 35.2864 234.596 33.5824C237.246 31.8784 240.512 31.0264 244.394 31.0264C249.127 31.0264 252.677 32.2098 255.044 34.5764C257.458 36.8958 258.665 39.9724 258.665 43.8064V67.0234H250.287ZM249.577 51.6164L241.909 52.6104C240.347 52.7998 239.163 53.2731 238.359 54.0304C237.554 54.7404 237.152 55.6161 237.152 56.6574C237.152 57.6514 237.554 58.5034 238.359 59.2134C239.163 59.8761 240.299 60.2074 241.767 60.2074C243.423 60.2074 244.82 59.8998 245.956 59.2844C247.139 58.6691 248.038 57.7698 248.654 56.5864C249.269 55.4031 249.577 53.9358 249.577 52.1844V51.6164ZM274.945 61.6984L276.081 61.5564V81.2234H266.993V31.5234H275.229L275.797 35.9254C276.838 34.5528 278.305 33.3931 280.199 32.4464C282.092 31.4998 284.269 31.0264 286.731 31.0264C289.807 31.0264 292.529 31.7838 294.896 33.2984C297.262 34.8131 299.108 36.9431 300.434 39.6884C301.806 42.3864 302.493 45.5814 302.493 49.2734C302.493 52.9654 301.806 56.1841 300.434 58.9294C299.108 61.6748 297.262 63.8048 294.896 65.3194C292.576 66.7868 289.855 67.5204 286.731 67.5204C283.985 67.5204 281.595 66.9524 279.56 65.8164C277.572 64.6804 276.033 63.3078 274.945 61.6984ZM292.695 49.2734C292.695 46.2914 291.914 43.9011 290.352 42.1024C288.837 40.2564 286.849 39.3334 284.388 39.3334C282.873 39.3334 281.477 39.7358 280.199 40.5404C278.968 41.2978 277.974 42.4101 277.217 43.8774C276.459 45.2974 276.081 47.0961 276.081 49.2734C276.081 51.4034 276.459 53.2021 277.217 54.6694C277.974 56.1368 278.968 57.2728 280.199 58.0774C281.477 58.8348 282.873 59.2134 284.388 59.2134C286.849 59.2134 288.837 58.3141 290.352 56.5154C291.914 54.6694 292.695 52.2554 292.695 49.2734ZM309.426 15.9034H318.514V35.0024C319.603 33.8191 320.952 32.8724 322.561 32.1624C324.218 31.4051 326.064 31.0264 328.099 31.0264C330.797 31.0264 333.14 31.6181 335.128 32.8014C337.164 33.9848 338.726 35.7124 339.814 37.9844C340.903 40.2091 341.447 42.9781 341.447 46.2914V67.0234H331.862V47.4984C331.862 44.7531 331.318 42.6941 330.229 41.3214C329.141 39.9488 327.508 39.2624 325.33 39.2624C323.106 39.2624 321.402 40.0198 320.218 41.5344C319.082 43.0018 318.514 45.1081 318.514 47.8534V67.0234H309.426V15.9034Z" fill="#4F46E5"/>
                  <path d="M157.609 99.778C158.067 98.4624 159.505 97.7672 160.821 98.2253C162.136 98.6834 162.831 100.122 162.373 101.437C162.046 102.377 161.217 102.997 160.291 103.109C156.964 110.92 148.104 114.923 139.966 112.09C135.024 110.369 131.439 106.505 129.888 101.902L132.316 101.867C133.762 105.513 136.725 108.533 140.72 109.924C147.674 112.346 155.242 108.956 158.136 102.316C157.527 101.654 157.292 100.687 157.609 99.778ZM157.001 82.4489C164.156 84.9739 170.198 89.8449 174.201 96.1305C174.678 96.8797 174.678 97.8365 174.201 98.5856C170.044 105.114 163.685 110.115 156.167 112.548C158.473 111.216 160.456 109.457 161.986 107.393C166.14 104.886 169.665 101.443 172.267 97.3581C169.726 93.369 166.305 89.993 162.278 87.5016C160.893 85.5199 159.098 83.8016 157.001 82.4489ZM134.039 82.6374C131.977 84.0196 130.217 85.7603 128.871 87.7594C125.022 90.2237 121.747 93.5052 119.293 97.3581C121.806 101.304 125.181 104.651 129.153 107.134C130.641 109.218 132.585 111.004 134.857 112.371C127.572 109.877 121.416 104.959 117.358 98.5856C116.881 97.8365 116.881 96.8796 117.358 96.1305C121.263 89.9975 127.112 85.2117 134.039 82.6374ZM145.778 86.1462C151.756 86.1464 156.603 91.1108 156.603 97.235C156.603 103.359 151.756 108.325 145.778 108.325C139.799 108.325 134.952 103.36 134.952 97.235C134.953 91.1107 139.799 86.1462 145.778 86.1462ZM303.766 89.1188C304.378 89.1188 305.006 89.1575 305.65 89.236C306.309 89.3145 306.85 89.4171 307.275 89.5426V92.3678C305.94 92.2265 305.053 92.1559 304.614 92.1559C303.546 92.1559 302.807 92.2662 302.4 92.486C302.007 92.6901 301.756 93.1218 301.647 93.7809C301.537 94.4245 301.482 95.634 301.482 97.4079C301.482 99.1816 301.537 100.398 301.647 101.057C301.756 101.701 302.007 102.132 302.4 102.352C302.807 102.556 303.546 102.659 304.614 102.659C305.524 102.659 306.435 102.588 307.345 102.447V105.296C306.905 105.405 306.348 105.5 305.673 105.579C304.998 105.657 304.363 105.696 303.766 105.696C301.992 105.696 300.681 105.453 299.833 104.966C299.001 104.464 298.444 103.648 298.161 102.517C297.895 101.387 297.761 99.684 297.761 97.4079C297.761 95.163 297.903 93.4747 298.185 92.3444C298.468 91.1985 299.025 90.3741 299.857 89.8717C300.705 89.3695 302.008 89.1188 303.766 89.1188ZM315.964 89.1188C317.942 89.1188 319.348 89.3617 320.18 89.8483C321.027 90.3192 321.553 91.0808 321.757 92.1325C321.961 93.1843 322.064 94.9432 322.064 97.4079C322.064 99.8724 321.961 101.631 321.757 102.682C321.553 103.734 321.027 104.503 320.18 104.99C319.348 105.461 317.942 105.696 315.964 105.696C314.002 105.696 312.597 105.461 311.749 104.99C310.917 104.503 310.392 103.734 310.172 102.682C309.968 101.615 309.865 99.8566 309.865 97.4079C309.865 94.9589 309.968 93.2078 310.172 92.1559C310.392 91.0886 310.917 90.3192 311.749 89.8483C312.597 89.3617 314.002 89.1188 315.964 89.1188ZM187.708 89.3073C189.011 89.3073 189.993 89.5192 190.652 89.943C191.311 90.3511 191.751 90.9395 191.97 91.7087C192.206 92.4779 192.323 93.5063 192.323 94.7936C192.323 96.018 192.214 97.0147 191.994 97.7838C191.79 98.553 191.351 99.1655 190.676 99.6208C190 100.076 189.003 100.303 187.685 100.303H184.788V105.507H181.139V89.3073H187.708ZM201.724 89.3073C203.058 89.3073 204.064 89.5114 204.739 89.9196C205.413 90.312 205.86 90.8771 206.08 91.6149C206.316 92.3527 206.434 93.3339 206.434 94.5583C206.434 95.7042 206.308 96.6853 206.057 97.5016C205.806 98.3022 205.295 98.8905 204.527 99.2672L206.787 105.507H202.948L201.065 99.8327H198.71V105.507H195.06V89.3073H201.724ZM213.206 105.507H209.532V89.3073H213.206V105.507ZM221.991 101.623H222.18L224.887 89.3073H228.584L224.558 105.507H219.495L215.468 89.3073H219.212L221.991 101.623ZM242.543 105.507H238.822L237.998 102.258H233.218L232.442 105.507H228.768L233.1 89.3073H238.235L242.543 105.507ZM254.019 92.4626H250.18V105.507H246.506V92.4626H242.692V89.3073H254.019V92.4626ZM266.137 92.3444H260.038V95.8063H265.266V98.8434H260.038V102.47H266.137V105.507H256.388V89.3073H266.137V92.3444ZM281.755 105.507H278.034L277.209 102.258H272.43L271.653 105.507H267.98L272.312 89.3073H277.446L281.755 105.507ZM287.674 105.507H284V89.3073H287.674V105.507ZM294.739 105.507H291.067V102.258H294.739V105.507ZM333.157 99.6911H333.322L336.031 89.3073H341.234V105.507H337.702V94.2995H337.537L334.594 105.507H331.721L328.801 94.2995H328.636V105.507H325.197V89.3073H330.449L333.157 99.6911ZM145.808 90.6647C143.878 90.6649 142.313 92.2682 142.313 94.2458C142.313 95.5334 142.976 96.6626 143.972 97.2936L143.087 102.572C142.992 103.137 143.417 103.653 143.976 103.653H147.523C148.082 103.653 148.506 103.136 148.411 102.572L147.536 97.359C148.592 96.7427 149.304 95.5793 149.304 94.2458C149.304 92.2681 147.739 90.6647 145.808 90.6647ZM315.964 92.1559C315.117 92.1559 314.543 92.2431 314.245 92.4157C313.963 92.5885 313.782 92.9961 313.703 93.6393C313.625 94.283 313.586 95.5398 313.586 97.4079C313.586 99.2758 313.625 100.532 313.703 101.175C313.782 101.819 313.963 102.227 314.245 102.4C314.543 102.573 315.117 102.659 315.964 102.659C316.812 102.659 317.377 102.573 317.659 102.4C317.958 102.227 318.147 101.819 318.225 101.175C318.304 100.532 318.343 99.2758 318.343 97.4079C318.343 95.5398 318.304 94.283 318.225 93.6393C318.147 92.9959 317.958 92.5884 317.659 92.4157C317.377 92.2431 316.812 92.1559 315.964 92.1559ZM233.948 99.2438H237.268L235.667 92.6032H235.526L233.948 99.2438ZM273.159 99.2438H276.481L274.879 92.6032H274.738L273.159 99.2438ZM184.788 97.2663H186.437C187.127 97.2663 187.622 97.211 187.92 97.1012C188.218 96.9757 188.415 96.756 188.509 96.4421C188.604 96.1124 188.651 95.5629 188.651 94.7936C188.651 94.0244 188.604 93.4826 188.509 93.1686C188.415 92.8391 188.218 92.6193 187.92 92.5094C187.622 92.3996 187.127 92.3444 186.437 92.3444H184.788V97.2663ZM198.71 96.819H200.547C201.237 96.819 201.724 96.7638 202.006 96.654C202.305 96.5441 202.501 96.3477 202.595 96.0651C202.689 95.7668 202.737 95.2724 202.737 94.5817C202.737 93.8754 202.689 93.3809 202.595 93.0983C202.517 92.8001 202.328 92.6036 202.03 92.5094C201.747 92.3997 201.261 92.3444 200.571 92.3444H198.71V96.819ZM130.606 90.8893C133.933 83.0783 142.794 79.0765 150.931 81.9098C155.873 83.6309 159.459 87.4941 161.01 92.0973L158.582 92.1325C157.136 88.4864 154.172 85.466 150.177 84.0749C143.223 81.6536 135.654 85.0423 132.76 91.6823C133.37 92.3445 133.605 93.3117 133.288 94.2213C132.83 95.5367 131.393 96.2319 130.077 95.7741C128.762 95.316 128.067 93.8777 128.525 92.5622C128.852 91.6222 129.68 91.0013 130.606 90.8893Z" fill="#4F46E5"/>
                  <path d="M83.32 93.03C83.76 92.11 84.45 91.34 85.39 90.72C86.33 90.1 87.52 89.79 88.96 89.79C90.34 89.79 91.54 90.11 92.56 90.75C93.6 91.39 94.4 92.29 94.96 93.45C95.54 94.59 95.83 95.94 95.83 97.5C95.83 99.06 95.54 100.42 94.96 101.58C94.38 102.74 93.57 103.64 92.53 104.28C91.51 104.9 90.32 105.21 88.96 105.21C87.6 105.21 86.47 104.92 85.57 104.34C84.67 103.76 83.99 103.05 83.53 102.21L83.38 105H81.31V83.4H83.56V93.06L83.32 93.03ZM93.4 97.5C93.4 95.78 92.95 94.42 92.05 93.42C91.17 92.4 89.98 91.89 88.48 91.89C87.54 91.89 86.69 92.12 85.93 92.58C85.19 93.02 84.61 93.66 84.19 94.5C83.77 95.32 83.56 96.32 83.56 97.5C83.56 98.68 83.77 99.69 84.19 100.53C84.61 101.37 85.19 102.01 85.93 102.45C86.69 102.89 87.54 103.11 88.48 103.11C89.98 103.11 91.17 102.61 92.05 101.61C92.95 100.59 93.4 99.22 93.4 97.5ZM109.673 90H112.013L103.433 111H101.273L103.823 104.79L97.7634 90H100.223L105.023 102.12L109.673 90Z" fill="#4F46E5"/>
              </svg>
            </div>
            <div class="header-logo-wrap">
              <a class="header-logo" href="/articles">{% trans 'Scientific Articles AI' %}</a>
            </div>
            <div class="header-right-side">
              {% if user.is_authenticated %}
              <!-- {% trans 'Hello,' %} -->
              <button class="profile-button" title="{{ user.username }}">{{ user.username|slice:":1" }}</button>
              <span>
                <form id="logout-form" method="post" action="{% url 'logout' %}" style="display: none">{% csrf_token %}</form>
                <a class="primary-button" href="#" onclick="document.getElementById('logout-form').submit(); return false;">{% trans 'Log out' %}</a>
              </span>
              {% else %}
              <a class="primary-button" href="{% url 'login' %}">{% trans 'Log in' %}</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </header>
    {% if user.is_authenticated %}
    <div class="header-row-full-width sticky">
      <div class="header-row">
        <nav class="header-nav">
          <a targetName="articles" href="{% url 'article_list' %}">{% trans 'My Articles' %}</a>
          <a targetName="add_article" href="{% url 'submit_article' %}">{% trans 'Add Article' %}</a>
        </nav>
      </div>
    </div>
    {% endif %}
    <div class="page">
      {% if messages %}
      <ul class="messages">
        {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %} {% block content %}{% endblock %}
    </div>
    <footer>
      <p style="text-align: center; color: #777; font-size: 0.8em">&copy; {% now "Y" %} Scientific Papers AI App</p>
    </footer>
    {% block extra_js %}{% endblock %}

    <script>
      const LocalStorageKeys = {
        notifications: "notificationsShow",
      };

      const navLinks = document.querySelectorAll(".header-nav a");
      const pathname = window.location.pathname;

      const checkCurrentLink = (link) => {
        const targetName = link.getAttribute("targetName");

        if ((pathname === "/" || pathname.includes("/articles") || pathname.includes("/article")) && targetName === "articles") {
          link.classList.add("current");
        }

        if (pathname.includes("/submit") && targetName === "add_article") {
          link.classList.add("current");
        }
      };

      navLinks.forEach((link) => {
        checkCurrentLink(link);
      });

      const tabButtons = document.querySelectorAll(".tab-button");
      const tabContents = document.querySelectorAll(".tab-content");

      function activateTab(tabId) {
        tabButtons.forEach((btn) => btn.classList.remove("active"));
        tabContents.forEach((content) => content.classList.remove("active"));

        const targetButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
        const targetContent = document.getElementById(tabId);

        if (targetButton && targetContent) {
          targetButton.classList.add("active");
          targetContent.classList.add("active");
        }
      }

      const urlParams = new URLSearchParams(window.location.search);
      const initialTab = urlParams.get("tab") || "available-content-and-raw-data";

      activateTab(initialTab);

      tabButtons.forEach((button) => {
        button.addEventListener("click", () => {
          const selectedTab = button.getAttribute("data-tab");
          activateTab(selectedTab);

          const newUrl = new URL(window.location);
          newUrl.searchParams.set("tab", selectedTab);
          window.history.replaceState({}, "", newUrl);
        });
      });

      function handleSegmentToggle({ tab, parentClass, listClass, root }) {
        return; // turn off toggle open

        const currentParnet = event.currentTarget.closest(parentClass);

        const containsShowClass = currentParnet.classList.contains("show");

        currentParnet.classList.toggle("show");

        const allSegments = event.currentTarget.closest(root).querySelectorAll(parentClass);

        allSegments.forEach((segment) => {
          if (currentParnet !== segment) segment.classList.remove("show");
        });

        if (!containsShowClass) currentParnet.scrollIntoView();
      }

      const notificationButtons = document.querySelectorAll("#notifications-toggle-button");
      const notificationContainer = document.querySelector("#notifications-wrapper");

      function notificationToggle() {
        notificationContainer.classList.toggle("show");

        const containsShowClass = notificationContainer.classList.contains("show");

        localStorage.setItem(LocalStorageKeys.notifications, containsShowClass);
      }

      const onLoadNotificationLocalStorageData = localStorage.getItem(LocalStorageKeys.notifications);

      if (onLoadNotificationLocalStorageData === "true") {
        notificationToggle();
      }

      notificationButtons.forEach((notificationButton) => {
        notificationButton.onclick = () => {
          notificationToggle();
        };
      });

      const hash = window.location.hash.substring(1);

      const decodedHash = decodeURIComponent(hash);

      const searchParams = new URLSearchParams(window.location.search);

      const segmentIDGetParam = searchParams.get("segmentID");

      const decodedSegmentIDGetParam = decodeURIComponent(segmentIDGetParam);

      if (!segmentIDGetParam && hash && document.getElementById(decodedHash)) {
        setTimeout(() => {
          document.getElementById(decodedHash).scrollIntoView({
            behavior: "smooth",
          });
        }, 300);
      }
      if (!!segmentIDGetParam && document.getElementById(`segment-${decodedSegmentIDGetParam}`)) {
        setTimeout(() => {
          document.getElementById(`segment-${decodedSegmentIDGetParam}`).scrollIntoView({
            behavior: "smooth",
            block: "end",
          });
        }, 300);
      }
    </script>
  </body>
</html>
